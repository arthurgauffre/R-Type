<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>R-Type: Specializing enum conversion</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">R-Type
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Specializing enum conversion </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>By default, enum values are serialized to JSON as integers. In some cases this could result in undesired behavior. If an enum is modified or re-ordered after data has been serialized to JSON, the later de-serialized JSON data may be undefined or a different enum value than was originally intended.</p>
<p>It is possible to more precisely specify how a given enum is mapped to and from JSON as shown below:</p>
<div class="fragment"><div class="line"><span class="comment">// example enum type declaration</span></div>
<div class="line"><span class="keyword">enum</span> TaskState {</div>
<div class="line">    TS_STOPPED,</div>
<div class="line">    TS_RUNNING,</div>
<div class="line">    TS_COMPLETED,</div>
<div class="line">    TS_INVALID=-1,</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// map TaskState values to JSON as strings</span></div>
<div class="line">NLOHMANN_JSON_SERIALIZE_ENUM( TaskState, {</div>
<div class="line">    {TS_INVALID, <span class="keyword">nullptr</span>},</div>
<div class="line">    {TS_STOPPED, <span class="stringliteral">&quot;stopped&quot;</span>},</div>
<div class="line">    {TS_RUNNING, <span class="stringliteral">&quot;running&quot;</span>},</div>
<div class="line">    {TS_COMPLETED, <span class="stringliteral">&quot;completed&quot;</span>},</div>
<div class="line">})</div>
</div><!-- fragment --><p>The <a class="el" href="md_3rd_party_lib_json_docs_mkdocs_docs_api_macros_nlohmann_json_serialize_enum.html">`NLOHMANN_JSON_SERIALIZE_ENUM()` macro</a> declares a set of <code>to_json()</code> / <code>from_json()</code> functions for type <code>TaskState</code> while avoiding repetition and boilerplate serialization code.</p>
<h1><a class="anchor" id="autotoc_md1365"></a>
Usage</h1>
<div class="fragment"><div class="line"><span class="comment">// enum to JSON as string</span></div>
<div class="line"><a class="code" href="classnlohmann_1_1basic__json.html">json</a> j = TS_STOPPED;</div>
<div class="line">assert(j == <span class="stringliteral">&quot;stopped&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// json string to enum</span></div>
<div class="line"><a class="code" href="classnlohmann_1_1basic__json.html">json</a> j3 = <span class="stringliteral">&quot;running&quot;</span>;</div>
<div class="line">assert(j3.template get&lt;TaskState&gt;() == TS_RUNNING);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// undefined json value to enum (where the first map entry above is the default)</span></div>
<div class="line"><a class="code" href="classnlohmann_1_1basic__json.html">json</a> jPi = 3.14;</div>
<div class="line">assert(jPi.template get&lt;TaskState&gt;() == TS_INVALID );</div>
<div class="ttc" id="aclassnlohmann_1_1basic__json_html"><div class="ttname"><a href="classnlohmann_1_1basic__json.html">nlohmann::basic_json</a></div><div class="ttdoc">a class to store JSON values</div><div class="ttdef"><b>Definition:</b> json_v3_10_5.hpp:17282</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1366"></a>
Notes</h1>
<p>Just as in <a class="el" href="md_3rd_party_lib_json_docs_mkdocs_docs_features_arbitrary_types.html">Arbitrary Type Conversions</a> above,</p>
<ul>
<li><a class="el" href="md_3rd_party_lib_json_docs_mkdocs_docs_api_macros_nlohmann_json_serialize_enum.html">`NLOHMANN_JSON_SERIALIZE_ENUM()`</a> MUST be declared in your enum type's namespace (which can be the global namespace), or the library will not be able to locate it, and it will default to integer serialization.</li>
<li>It MUST be available (e.g., proper headers must be included) everywhere you use the conversions.</li>
</ul>
<p>Other Important points:</p>
<ul>
<li>When using <code>template get&lt;ENUM_TYPE&gt;()</code>, undefined JSON values will default to the first pair specified in your map. Select this default pair carefully.</li>
<li>If an enum or JSON value is specified more than once in your map, the first matching occurrence from the top of the map will be returned when converting to or from JSON.</li>
<li>To disable the default serialization of enumerators as integers and force a compiler error instead, see <a class="el" href="md_3rd_party_lib_json_docs_mkdocs_docs_api_macros_json_disable_enum_serialization.html">`JSON_DISABLE_ENUM_SERIALIZATION`</a>. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
